{"version":3,"file":"bundle.js","sources":["/Users/jueyang/github/CHD08_force_feed/node_modules/grunt-browserify/node_modules/browserify/node_modules/browser-pack/_prelude.js","/Users/jueyang/github/CHD08_force_feed/src/js/app.js","/Users/jueyang/github/CHD08_force_feed/src/js/outer-context.js","/Users/jueyang/github/CHD08_force_feed/src/js/util.js","/Users/jueyang/github/CHD08_force_feed/src/js/ui.js","/Users/jueyang/github/CHD08_force_feed/src/js/article.js","/Users/jueyang/github/CHD08_force_feed/src/js/form.js"],"names":["w","window","FF","debug","useMock","mockData","tnum","url","mockResponse","template","content","type","$","require","OuterContext","init","ext","this","isExt","events","chrome","runtime","onMessage","addListener","messageHandler","bind","setTimeout","request","event","visible","trigger","button","article","util","on","triggerUtil","rangeslider","polyfill","ui","preparePage","getUITemplate","show","hide","$page","wrapInner","extension","getURL","get","storeTemplate","d","$template","insertAfter","setAnimations","templateReady","animation","TimelineMax","pause","to","x","wait","timer","setInterval","clearInterval","toggle","isActive","play","reverse","Article","slideshowIterator","imageLoadAmount","allImagesLoaded","isPostLoad","remove","renderStart","e","$active","data","JSON","parse","t","Number","cacheTemplate","render","imgI","$content","find","console","dir","prop","obj","$el","append","html","img","div","imageLoaded","templateA","templateB","$images","slideshow","eq","addClass","Form","submit","preventDefault","handleRanges","getUrl","message","sendMessage","values","$r","each","v","val","Math","round","attr","s","location","href"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var w = window;\nvar FF = w.FF = {};\n\nFF.debug = true;\nFF.useMock = true;\n\nFF.mockData = {\n\ttnum: 1,\n\turl: \"http://www.huffingtonpost.com/2015/05/13/amtrak-crash-speed-limit_n_7276902.html\"\n}\n\nFF.mockResponse = {\"template\":1,\"content\":[{\"type\":\"text\",\"content\":\"ASSOCIATED PRESS\\n            \\n        \\n        \\t\\t  \\n        An Amtrak train that derailed in Philadelphia on Tuesday night had been going over 100 mph before the crash, the National Transportation Safety Board announced on Wednesday -- more than twice the legal speed limit.Sources familiar with the investigation of the crash told The Wall Street Journal that the train hit a sharp curve and failed to slow down\"},{\"type\":\"image\",\"content\":\"http://media2.giphy.com/media/FOwqXrc38glPO/200.gif\"},{\"type\":\"image\",\"content\":\"https://i.vimeocdn.com/channel/196544_980?mh=250\"},{\"type\":\"image\",\"content\":\"http://media3.giphy.com/media/lNwtH9yTWONW/200.gif\"},{\"type\":\"image\",\"content\":\"https://i.vimeocdn.com/channel/196544_980?mh=250\"},{\"type\":\"image\",\"content\":\"http://www.pbs.org/newshour/wp-content/uploads/2014/06/148123164.jpg\"},{\"type\":\"text\",\"content\":\" Officialsfamiliar with the crash also confirmed this to Reuters on Wednesday\"},{\"type\":\"image\",\"content\":\"http://www.thepca.org/wp-content/uploads/2009/12/January-2011-Newsletter.jpg\"},{\"type\":\"image\",\"content\":\"http://media3.giphy.com/media/d8nTTQ5QxCJvG/200.gif\"},{\"type\":\"image\",\"content\":\"http://media0.giphy.com/media/S0fijaOA7fbfW/200.gif\"},{\"type\":\"image\",\"content\":\"http://media0.giphy.com/media/J4SymBQ8QAFYQ/200.gif\"},{\"type\":\"image\",\"content\":\"http://www.thepca.org/wp-content/uploads/2009/12/January-2011-Newsletter.jpg\"},{\"type\":\"text\",\"content\":\" Speeding has been the cause of several majortrain crashes in recent years\"},{\"type\":\"image\",\"content\":\"http://media1.giphy.com/media/d8nTTQ5QxCJvG/200.gif\"},{\"type\":\"image\",\"content\":\"http://www.gannett-cdn.com/-mm-/0dcd2de70c10c28aab093f5f679e435332de36ec/c=0-107-3578-2128&r=x1683&c=3200x1680/local/-/media/2015/05/12/Wilmington/Wilmington/635670714206452298-APTOPIX-Amtrak-Crash.jpg\"},{\"type\":\"image\",\"content\":\"http://s1.ibtimes.com/sites/www.ibtimes.com/files/styles/v2_article_large/public/2013/05/17/metro-north_railroad_collision-may_17_2013.jpg?itok=70igz5no\"},{\"type\":\"image\",\"content\":\"http://media3.giphy.com/media/lNwtH9yTWONW/200.gif\"},{\"type\":\"image\",\"content\":\"http://media3.giphy.com/media/d8nTTQ5QxCJvG/200.gif\"}]}\n\n$(function(){\n\trequire('./util');\n\trequire('./outer-context');\n\trequire('./ui');\n\trequire('./article');\n\trequire('./form');\n});\n","(function(w){\n\tvar OuterContext = {\n\t\t\n\t\t/*\n\t\t * Init stuff\n\t\t * @params void\n\t\t * @returns void\n\t\t */\n\t\tinit:function(){\n\t\t\tw.FF.ext = this.isExt();\n\t\t\tthis.events();\n\t\t},\n\t\t\n\t\t/*\n\t\t * Declare event handlers\n\t\t * @params void\n\t\t * @returns void\n\t\t */\n\t\tevents:function(){\n\t\t\tif (w.FF.ext){\n\t\t\t\tchrome.runtime.onMessage.addListener(this.messageHandler.bind(this));\n\t\t\t} else {\n\t\t\t\tsetTimeout(this.messageHandler.bind(this),200);\n\t\t\t}\n\t\t},\n\t\t\n\t\t/* \n\t\t * Determines is this script has been called\n\t\t * as part of an extension or statically \n\t\t * for development purposes\n\t\t * @param void\n\t\t * @returns void\n\t\t */\n\t\tisExt:function(){\n\t\t\tif (chrome && chrome.runtime.onMessage){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t\n\t\t/* \n\t\t * Handles all messages from the outer context\n\t\t * @param\tmixed the message send from the outer context\n\t\t * @returns void\n\t\t */\n\t\tmessageHandler:function(request){\n\t\t\t//Just pretending for dev purposes\n\t\t\tif (!request){\n\t\t\t\tvar event = window.FF.visible ? 'ex-hide' : 'ex-show';\n\t\t\t\t$('body').trigger(event);\n\t\t\t\treturn;\n\t\t\t\n\t\t\t//Extension button click related\n\t\t\t} else if (request.button){\n\t\t\t\tvar event = window.FF.visible ? 'ex-hide' : 'ex-show';\n\t\t\t\t$('body').trigger(event);\n\t\t\t\n\t\t\t//End of XHR\n\t\t\t} else if (request.article){\n\t\t\t\t$('body').trigger('article-data-ready',[request.article]);\n\t\t\t}\n\t\t}\n\t};\n\t\n\tOuterContext.init();\n\t\n})(window);","(function(w){\n\tvar util = {\n\t\tinit:function(){\n\t\t\tthis.events();\n\t\t},\n\t\tevents:function(){\n\t\t\t$('body')\n\t\t\t\t.on('ui-ready',this.triggerUtil.bind(this));\n\t\t},\n\t\ttriggerUtil:function(){\n\t\t\tthis.rangeslider();\n\t\t},\n\t\trangeslider:function(){\n\t\t\t$('[type=\"range\"]').rangeslider({\n\t\t    polyfill: false\n\t\t  });\n\t\t}\n\t};\n\t\n\tutil.init();\n\t\n})(window);","(function(w){\n\tvar ui = {\n\t\t\n\t\t/*\n\t\t * Init stuff\n\t\t * @params void\n\t\t * @returns void\n\t\t */\n\t\tinit:function(){\n\t\t\tthis.preparePage();\n\t\t\tthis.getUITemplate();\n\t\t\tthis.events();\n\t\t},\n\t\tevents:function(){\n\t\t\t$('body')\n\t\t\t\t.on('ex-show',this.show.bind(this))\n\t\t\t\t.on('ex-hide',this.hide.bind(this));\n\t\t},\n\t\tpreparePage:function(){\n\t\t\tthis.$page = $('body').wrapInner('<div class=\"FF_bodywrap\"></div>');\t\t},\n\t\tgetUITemplate:function(){\n\t\t\tvar url;\n\t\t\t\n\t\t\tif (w.FF.ext){\n\t\t\t\turl = chrome.extension.getURL(\"templates/ui.html\");\n\t\t\t} else {\n\t\t\t\turl = 'templates/ui.html';\n\t\t\t}\n\t\t\t$.get(url,this.storeTemplate.bind(this));\n\t\t},\n\t\tstoreTemplate:function(d){\n\t\t\tthis.$template = $(d);\n\t\t\tthis.$template.insertAfter('.FF_bodywrap');\n\t\t\t$('body').trigger('ui-ready');\n\t\t\tthis.setAnimations();\n\t\t\tthis.templateReady = true;\n\t\t},\n\t\tsetAnimations:function(){\n\t\t\tthis.animation = \n\t\t\tnew TimelineMax()\n\t\t\t.pause()\n\t\t\t.to(this.$template, 1,{x:0});\n\t\t\t\t\n\t\t},\n\t\twait:function(){\n\t\t\tthis.timer = setInterval(function(){\n\t\t\t\tif (this.templateReady){\n\t\t\t\t\tthis.show();\n\t\t\t\t\tclearInterval(this.timer);\n\t\t\t\t}\n\t\t\t}.bind(this), 100);\t\n\t\t},\n\t\ttoggle:function(){\n\t\t\twindow.FF.visible = window.FF.visible ? false : true;\t\n\t\t},\n\t\tshow:function(){\n\t\t\tif (!this.templateReady){\n\t\t\t\tthis.wait();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.animation.isActive()) return;\n\t\t\tthis.toggle();\n\t\t\tthis.animation.play(0);\n\t\t},\n\t\thide:function(){\n\t\t\tif (this.animation.isActive()) return;\n\t\t\tthis.toggle();\n\t\t\tthis.animation.reverse(0);\n\t\t}\n\t};\n\t\n\tui.init();\n\t\n})(window);","(function(w){\n\t\n\tvar Article = {\n\t\t\n\t\t/*\n\t\t * Init Stuff\n\t\t * @params void\n\t\t * @returns void\n\t\t */\n\t\tinit:function(){\n\t\t\tthis.slideshowIterator = 0;\n\t\t\tthis.imageLoadAmount = 0;\n\t\t\tthis.allImagesLoaded = false;\n\t\t\tthis.events();\n\t\t},\n\t\t\n\t\t/*\n\t\t * Declare event handlers\n\t\t * @param boolean is this function getting called post init?\n\t\t * @returns void\n\t\t */\n\t\tevents:function(isPostLoad){\n\t\t\t// Has to wait until the template is loaded\n\t\t\tif (isPostLoad){\n\t\t\t\t$('#FF_Article')\n\t\t\t\t\t.on('click','.exit',this.remove.bind(this));\n\t\t\t} else {\n\t\t\t\t$('body')\n\t\t\t\t\t.on('article-data-ready',this.renderStart.bind(this));\n\t\t\t}\n\t\t},\n\t\t\n\t\t/*\n\t\t * Do the preparation to get the response rendered to\n\t\t * the page! Acknowledge that the XHR request ended.\n\t\t * @param obj event object\n\t\t * @param obj data recieved from the endpoint\n\t\t * @returns void\n\t\t */\n\t\trenderStart:function(e,d){\n\t\t\t$('#FF_UI .loader').hide();\n\t\t\t\n\t\t\t// Is there a template on the page already?\n\t\t\tif (this.$active){\n\t\t\t\tthis.$active.remove();\n\t\t\t\tthis.$active = false;\n\t\t\t}\n\t\t\t\n\t\t\t// Use the real response or the mock?\n\t\t\tif (w.FF.useMock){\n\t\t\t\tthis.data = w.FF.mockResponse\n\t\t\t} else {\n\t\t\t\tthis.data = JSON.parse(d);\n\t\t\t}\n\t\t\t\n\t\t\t//Decide which template variant to use\n\t\t\tthis.type = t = Number(this.data.template) <= 2 ? 'a' : 'b';\n\t\t\t\n\t\t\t//If we have already fetched the template file..\n\t\t\tif (this['template_'+t]){\n\t\t\t\tthis.cacheTemplate();\n\t\t\t\treturn;\n\t\t\t} \n\t\t\t\n\t\t\t//Which URL to fetch (Are we in dev mode?)\n\t\t\tif (w.FF.ext){\n\t\t\t\turl = chrome.extension.getURL(\"templates/template-\"+t+\".html\");\n\t\t\t} else {\n\t\t\t\turl = \"templates/template-\"+t+\".html\";\n\t\t\t}\n\t\t\t\n\t\t\t//Love a bit of AJAX\n\t\t\t$.get(url,this.cacheTemplate.bind(this));\n\t\t},\n\t\t\n\t\t/*\n\t\t * Do the preparation to get the response rendered to\n\t\t * the page! Acknowledge that the XHR request ended.\n\t\t * @param obj data from XHR response\n\t\t * @returns void\n\t\t */\n\t\tcacheTemplate:function(d){\n\t\t\t//Cache a reference to the template HTML (raw)\n\t\t\tif (d && !this['template_'+this.type]){\n\t\t\t\tthis['template_'+this.type] = d || '';\n\t\t\t}\n\t\t\t\n\t\t\t//Get some DOM action\n\t\t\tthis.render();\n\t\t},\n\t\t\n\t\t/*\n\t\t * Render the template to the page!\n\t\t * @params\tvoid\n\t\t * @returns\tvoid\n\t\t */\n\t\trender:function(){\n\t\t\t//Reset necessary iterators etc\n\t\t\tvar imgI = 1;\n\t\t\tthis.imageLoadAmount = 0;\n\t\t\tthis.allImagesLoaded = false;\n\t\t\t\n\t\t\tvar t = this['template_'+this.type];\n\t\t\t\n\t\t\tthis.$active = $(t).insertAfter('.FF_bodywrap');\n\t\t\tthis.$content = this.$active.find('#FF__body');\n\t\t\n\t\t\tconsole.dir(this.data.content);\n\t\t\n\t\t\tfor (prop in this.data.content){\n\t\t\t\tvar obj = this.data.content[prop];\n\t\t\t\t\n\t\t\t\t//Handle text blocks\n\t\t\t\tif (obj.type == 'text'){\n\t\t\t\t\tvar $el = $('<p>');\n\t\t\t\t\tthis.$content.append($el.html(obj.content));\n\t\t\t\t\n\t\t\t\t//Handle images\n\t\t\t\t} else if (obj.type == 'image'){\n\t\t\t\t\tvar \n\t\t\t\t\t\timg = '<img class=\"FF-image-'+imgI+'\" src=\"'+obj.content+'\">',\n\t\t\t\t\t\tdiv = '<div class=\"FF-image-'+imgI+'\" style=\"background-image:url('+obj.content+')\">',\n\t\t\t\t\t\t$el = $(div);\n\t\t\t\t\t\n\t\t\t\t\t$(img).on('load',this.imageLoaded.bind(this));\n\t\t\t\t\t\n\t\t\t\t\tthis.$content.append(div);\n\t\t\t\t\t\n\t\t\t\t\timgI++;\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t\tswitch (this.type){\n\t\t\t\tcase 'a':\n\t\t\t\t\tthis.templateA();\n\t\t\t\tbreak;\n\t\t\t\tcase 'b':\n\t\t\t\t\tthis.templateB();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tthis.events(true);\n\t\t},\n\t\t\n\t\t/*\n\t\t * Register how many images have loaded\n\t\t * to the page\n\t\t */\n\t\timageLoaded:function(){\n\t\t\tthis.imageLoadAmount++;\n\t\t\tconsole.dir(this.imageLoadAmount)\n\t\t},\n\t\t\n\t\t/*\n\t\t * TEMPLATE A\n\t\t * Get into specifics on a per template basis\n\t\t * @params\tvoid\n\t\t * @returns\tvoid\n\t\t */\n\t\ttemplateA:function(){},\n\t\t\n\t\t/*\n\t\t * TEMPLATE B\n\t\t * Get into specifics on a per template basis\n\t\t * @params\tvoid\n\t\t * @returns\tvoid\n\t\t */\n\t\ttemplateB:function(){\n\t\t\tthis.$images = this.$content.find('div[class^=FF-image]');\n\t\t\tthis.timer();\n\t\t},\n\t\t\n\t\t/*\n\t\t * Iterate over each of the images\n\t\t * Changing the display prop of each\n\t\t */\n\t\tslideshow:function(){\n\t\t\tthis.$images.eq(this.slideshowIterator).addClass('visible')\n\t\t\tthis.slideshowIterator++;\n\t\t},\n\t\t\n\t\t/*\n\t\t * Lovely ol' timer\n\t\t */\n\t\ttimer: function(){\n\t\t\tsetInterval(this.slideshow.bind(this),200)\n\t\t},\n\t\t\n\t\t/*\n\t\t * Remove template from el pago\n\t\t * and hide the extension UI\n\t\t * @params\tvoid\n\t\t * @returns\tvoid\n\t\t */\n\t\tremove:function(){\n\t\t\tthis.$active.remove();\n\t\t\t$('body').trigger('ex-hide');\n\t\t}\n\t};\n\t\n\tArticle.init();\n\t\n})(window);","(function(w){\n\tvar Form = {\n\t\t\n\t\t/* Just Init\n\t\t * @param void\n\t\t * @returns void\n\t\t */\n\t\tinit:function(){\n\t\t\tthis.data = {};\n\t\t\tthis.events();\n\t\t},\n\t\t\n\t\t/* Call any events we need to listen out for\n\t\t * @param boolean is this function getting called post init?\n\t\t * @returns void\n\t\t */\n\t\tevents:function(isPostLoad){\n\t\t\tif (isPostLoad){\n\t\t\t\tthis.$el = $('#FF_UI form');\n\t\t\t\tthis.$el.on('submit',this.submit.bind(this));\n\t\t\t} else {\n\t\t\t\t$('body').on('ui-ready',this.events.bind(this,true));\n\t\t\t}\n\t\t},\n\t\t\n\t\t/* Handle the submit of the form\n\t\t * The backbone of the submission process\n\t\t * @param obj event object\n\t\t * @returns void\n\t\t */\n\t\tsubmit:function(e){\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tthis.handleRanges();\n\t\t\tthis.getUrl();\n\t\t\t\n\t\t\tif (w.FF.debug){\n\t\t\t\t//Bypass the whole XHR thing\n\t\t\t\t$('body').trigger('article-data-ready');\n\t\t\t} else {\n\t\t\t\tvar message = {};\n\t\t\t\tmessage['data'] = w.FF.useMock ? w.FF.mockData : this.data;\n\t\t\t\t\n\t\t\t\t$('#FF_UI .loader').show();\n\t\t\t\t\n\t\t\t\tconsole.dir(message);\n\t\t\t\t\n\t\t\t\t//Init XHR in other context\n\t\t\t\tchrome.runtime.sendMessage(message);\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t},\n\t\t\n\t\t/* Get range values which will determine the template\n\t\t * number to send to endpoint. Changes this.data as \n\t\t * apposet to returning value\n\t\t * @param void\n\t\t * @returns void\n\t\t */\n\t\thandleRanges:function(){\n\t\t\tvar values = {};\n\t\t\t\n\t\t\t$r = this.$el.find('[type=\"range\"]');\n\t\t\t$r.each(function(){\n\t\t\t\tvar v = $(this).val();\n\t\t\t\tv = Math.round(v/1000);\n\t\t\t\tvalues[$(this).attr('name')] = v;\n\t\t\t});\n\t\t\t\n\t\t\tvar \n\t\t\t\tt = values['time'],\n\t\t\t\ts = values['seriousness'];\n\t\t\t\n\t\t\tif (t && s){\n\t\t\t\tthis.data['tnum'] = 1;\n\t\t\t} else if (t && !s){\n\t\t\t\tthis.data['tnum'] = 2;\n\t\t\t} else if (!t && !s){\n\t\t\t\tthis.data['tnum'] = 3;\n\t\t\t} else {\n\t\t\t\tthis.data['tnum'] = 4;\n\t\t\t}\n\t\t\t\n\t\t\twindow.FF.template = this.data['tnum'];\n\t\t},\n\t\t\n\t\t/* Get the URL of the page\n\t\t * @param void\n\t\t * @returns void\n\t\t */\n\t\tgetUrl:function(){\n\t\t\tthis.data['url'] = window.location.href;\n\t\t}\n\t};\n\t\n\tForm.init();\n\t\n})(window);"]}